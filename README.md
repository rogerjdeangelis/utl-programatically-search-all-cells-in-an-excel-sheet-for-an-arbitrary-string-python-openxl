# utl-programatically-search-all-cells-in-an-excel-sheet-for-an-arbitrary-string-python-openxl
Programatically search all cells in an excel sheet for an arbitrary string python openxl; 
    %let pgm=utl-programatically-search-all-cells-in-an-excel-sheet-for-an-arbitrary-string-python-openxl;

    Programatically search all cells in an excel sheet for an arbitrary string python openxl;

    github
    https://tinyurl.com/yzvm6vr9
    https://github.com/rogerjdeangelis/utl-programatically-search-all-cells-in-an-excel-sheet-for-an-arbitrary-string-python-openxl

    see
    https://goo.gl/MtPbkU
    http://stackoverflow.com/questions/43744659/how-to-find-all-cells-in-a-work-book-that-contain-strings-that-look-like-tk005

    Craig's profile
    http://stackoverflow.com/users/7517724/craig


    /*               _     _
     _ __  _ __ ___ | |__ | | ___ _ __ ___
    | `_ \| `__/ _ \| `_ \| |/ _ \ `_ ` _ \
    | |_) | | | (_) | |_) | |  __/ | | | | |
    | .__/|_|  \___/|_.__/|_|\___|_| |_| |_|
    |_|
    */

    /**************************************************************************************************************************/
    /*                                                                                                                        */
    /* INPUT                                                                                                                  */
    /* =====                                                                                                                  */
    /*                                                                                                                        */
    /* %let str=Alice;  * search string;                                                                                      */
    /*                                                                                                                        */
    /* d:/xls/class.xlsx                                                                                                      */
    /*                                                                                                                        */
    /*   +----------------------------------------------------------------+                                                   */
    /*   |     A      |    B       |     C      |    D       |    E       |                                                   */
    /*   +----------------------------------------------------------------+                                                   */
    /* 1 |  NAME      |   SEX      |    AGE     |  HEIGHT    |  WEIGHT    |                                                   */
    /*   +------------+------------+------------+------------+------------+                                                   */
    /* 2 | Alfred     |    M       |    14      |    69      |  112.5     |                                                   */
    /*   +------------+------------+------------+------------+------------+                                                   */
    /* 3 | Alice      |    F       |    15      |    68      |  102.5     |                                                   */
    /*   +------------+------------+------------+------------+------------+                                                   */
    /*    ...                                                                                                                 */
    /*   +------------+------------+------------+------------+------------+                                                   */
    /* N | WILMA      |    F       |    15      |   66.5     |  112       |                                                   */
    /*   +------------+------------+------------+------------+------------+                                                   */
    /*                                                                                                                        */
    /* [CLASS]                                                                                                                */
    /*                                                                                                                        */
    /*------------------------------------------------------------------------------------------------------------------------*/
    /*                                                                                                                        */
    /* PROCESS                                                                                                                */
    /* =======                                                                                                                */
    /*                                                                                                                        */
    /* %utl_submit_py64_310('                                                                                                 */
    /* # -*- coding: utf-8 -*-;                                                                                               */
    /* import openpyxl;                                                                                                       */
    /* wb = openpyxl.load_workbook("d:/xls/class.xlsx", read_only=False);                                                     */
    /* ws = wb.active;                                                                                                        */
    /* for row in ws.iter_rows():;                                                                                            */
    /* .   for cell in row:;                                                                                                  */
    /* .       if cell.value == "Alice":;                                                                                     */
    /* .           print("Cell: [{}] is type({}):.''{}''".format(cell.coordinate, type(cell.value).__name__, cell.value));    */
    /* ');                                                                                                                    */
    /*                                                                                                                        */
    /*------------------------------------------------------------------------------------------------------------------------*/
    /*                                                                                                                        */
    /* OUTPUT                                                                                                                 */
    /* ======                                                                                                                 */
    /*                                                                                                                        */
    /* Cell: [A3] is type(str):.'Alice'                                                                                       */
    /*                                                                                                                        */
    /**************************************************************************************************************************/

    /*                   _
    (_)_ __  _ __  _   _| |_
    | | `_ \| `_ \| | | | __|
    | | | | | |_) | |_| | |_
    |_|_| |_| .__/ \__,_|\__|
            |_|
    */

    %let str=Alice;  * search string;

    ods excel file="d:/xls/class.xlsx" options(sheet_name="class");
    proc report data=sashelp.class;
    run;quit;
    ods excel close;

    /**************************************************************************************************************************/
    /*                                                                                                                        */
    /* %let str=Alice;  * search string;                                                                                      */
    /*                                                                                                                        */
    /* d:/xls/class.xlsx                                                                                                      */
    /*                                                                                                                        */
    /*   +----------------------------------------------------------------+                                                   */
    /*   |     A      |    B       |     C      |    D       |    E       |                                                   */
    /*   +----------------------------------------------------------------+                                                   */
    /* 1 |  NAME      |   SEX      |    AGE     |  HEIGHT    |  WEIGHT    |                                                   */
    /*   +------------+------------+------------+------------+------------+                                                   */
    /* 2 | Alfred     |    M       |    14      |    69      |  112.5     |                                                   */
    /*   +------------+------------+------------+------------+------------+                                                   */
    /* 3 | Alice      |    F       |    15      |    68      |  102.5     |                                                   */
    /*   +------------+------------+------------+------------+------------+                                                   */
    /*    ...                                                                                                                 */
    /*   +------------+------------+------------+------------+------------+                                                   */
    /* N | WILMA      |    F       |    15      |   66.5     |  112       |                                                   */
    /*   +------------+------------+------------+------------+------------+                                                   */
    /*                                                                                                                        */
    /* [CLASS]                                                                                                                */
    /*                                                                                                                        */
    /**************************************************************************************************************************/

    /*
     _ __  _ __ ___   ___ ___  ___ ___
    | `_ \| `__/ _ \ / __/ _ \/ __/ __|
    | |_) | | | (_) | (_|  __/\__ \__ \
    | .__/|_|  \___/ \___\___||___/___/
    |_|
    */

    %utl_submit_py64_310('
    # -*- coding: utf-8 -*-;
    import openpyxl;
    wb = openpyxl.load_workbook("d:/xls/class.xlsx", read_only=False);
    ws = wb.active;
    for row in ws.iter_rows():;
    .   for cell in row:;
    .       if cell.value == "Alice":;
    .           print("Cell: [{}] is type({}):.''{}''".format(cell.coordinate, type(cell.value).__name__, cell.value));

    /*           _               _
      ___  _   _| |_ _ __  _   _| |_
     / _ \| | | | __| `_ \| | | | __|
    | (_) | |_| | |_| |_) | |_| | |_
     \___/ \__,_|\__| .__/ \__,_|\__|
                    |_|
    */

    /**************************************************************************************************************************/
    /*                                                                                                                        */
    /*  Cell: [A3] is type(str):.'Alice'                                                                                      */
    /*                                                                                                                        */
    /*                                                                                                                        */
    /**************************************************************************************************************************/

    /*              _
      ___ _ __   __| |
     / _ \ `_ \ / _` |
    |  __/ | | | (_| |
     \___|_| |_|\__,_|

    */
